define(["./bundle/lookup","./common/create_error","./common/validate","./common/validate/presence","./common/validate/type","./common/validate/type/path","./common/validate/type/plain_object","./common/validate/type/string","./core/likely_subtags","./core/load","./core/remove_likely_subtags","./core/subtags","./item/get_resolved","./path/normalize","./resource/get","./util/always_array","./util/json/merge"],function(bundleLookup,createError,validate,validatePresence,validateType,validateTypePath,validateTypePlainObject,validateTypeString,coreLikelySubtags,coreLoad,coreRemoveLikelySubtags,coreSubtags,itemGetResolved,pathNormalize,resourceGet,alwaysArray,jsonMerge){var Cldr=function(locale){this.init(locale)};Cldr._alwaysArray=alwaysArray;Cldr._coreLoad=coreLoad;Cldr._createError=createError;Cldr._itemGetResolved=itemGetResolved;Cldr._jsonMerge=jsonMerge;Cldr._pathNormalize=pathNormalize;Cldr._resourceGet=resourceGet;Cldr._validatePresence=validatePresence;Cldr._validateType=validateType;Cldr._validateTypePath=validateTypePath;Cldr._validateTypePlainObject=validateTypePlainObject;Cldr._availableBundleMap={};Cldr._availableBundleMapQueue=[];Cldr._resolved={};Cldr.localeSep="-";Cldr.load=function(){Cldr._resolved=coreLoad(Cldr,Cldr._resolved,arguments)};Cldr.prototype.init=function(locale){var attributes,language,maxLanguageId,minLanguageId,script,subtags,territory,unicodeLocaleExtensions,variant,sep=Cldr.localeSep,unicodeLocaleExtensionsRaw="";validatePresence(locale,"locale");validateTypeString(locale,"locale");subtags=coreSubtags(locale);if(subtags.length===5){unicodeLocaleExtensions=subtags.pop();unicodeLocaleExtensionsRaw=sep+"u"+sep+unicodeLocaleExtensions;if(!subtags[3]){subtags.pop()}}variant=subtags[3];maxLanguageId=coreLikelySubtags(Cldr,this,subtags,{force:true})||subtags;language=maxLanguageId[0];script=maxLanguageId[1];territory=maxLanguageId[2];minLanguageId=coreRemoveLikelySubtags(Cldr,this,maxLanguageId).join(sep);this.attributes=attributes={bundle:bundleLookup(Cldr,this,minLanguageId),minLanguageId:minLanguageId+unicodeLocaleExtensionsRaw,maxLanguageId:maxLanguageId.join(sep)+unicodeLocaleExtensionsRaw,language:language,script:script,territory:territory,region:territory,variant:variant};unicodeLocaleExtensions&&("-"+unicodeLocaleExtensions).replace(/-[a-z]{3,8}|(-[a-z]{2})-([a-z]{3,8})/g,function(attribute,key,type){if(key){attributes["u"+key]=type}else{attributes["u"+attribute]=true}});this.locale=locale};Cldr.prototype.get=function(path){validatePresence(path,"path");validateTypePath(path,"path");return itemGetResolved(Cldr,path,this.attributes)};Cldr.prototype.main=function(path){validatePresence(path,"path");validateTypePath(path,"path");validate("E_MISSING_BUNDLE",this.attributes.bundle!==null,{locale:this.locale});path=alwaysArray(path);return this.get(["main/{bundle}"].concat(path))};return Cldr});