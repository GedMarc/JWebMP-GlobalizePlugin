define(["./first-day-of-week","./pattern-re","../common/create-error/unsupported-feature","../number/symbol","../util/string/pad"],function(dateFirstDayOfWeek,datePatternRe,createErrorUnsupportedFeature,numberSymbol,stringPad){return function(pattern,cldr){var properties={numberFormatters:{},pattern:pattern,timeSeparator:numberSymbol("timeSeparator",cldr)},widths=["abbreviated","wide","narrow"];function setNumberFormatterPattern(pad){properties.numberFormatters[pad]=stringPad("",pad)}pattern.replace(datePatternRe,function(current){var formatNumber,chr=current.charAt(0),length=current.length;if(chr==="j"){properties.preferredTime=chr=cldr.supplemental.timeData.preferred()}if(chr==="Z"&&length===4){chr="O";length=4}switch(chr){case"G":properties.eras=cldr.main(["dates/calendars/gregorian/eras",length<=3?"eraAbbr":length===4?"eraNames":"eraNarrow"]);break;case"y":formatNumber=true;break;case"Y":properties.firstDay=dateFirstDayOfWeek(cldr);properties.minDays=cldr.supplemental.weekData.minDays();formatNumber=true;break;case"u":case"U":throw createErrorUnsupportedFeature({feature:"year pattern `"+chr+"`"});case"Q":case"q":if(length>2){if(!properties.quarters){properties.quarters={}}if(!properties.quarters[chr]){properties.quarters[chr]={}}properties.quarters[chr][length]=cldr.main(["dates/calendars/gregorian/quarters",chr==="Q"?"format":"stand-alone",widths[length-3]])}else{formatNumber=true}break;case"M":case"L":if(length>2){if(!properties.months){properties.months={}}if(!properties.months[chr]){properties.months[chr]={}}properties.months[chr][length]=cldr.main(["dates/calendars/gregorian/months",chr==="M"?"format":"stand-alone",widths[length-3]])}else{formatNumber=true}break;case"w":case"W":properties.firstDay=dateFirstDayOfWeek(cldr);properties.minDays=cldr.supplemental.weekData.minDays();formatNumber=true;break;case"d":case"D":case"F":formatNumber=true;break;case"g":throw createErrorUnsupportedFeature({feature:"Julian day pattern `g`"});case"e":case"c":if(length<=2){properties.firstDay=dateFirstDayOfWeek(cldr);formatNumber=true;break}case"E":if(!properties.days){properties.days={}}if(!properties.days[chr]){properties.days[chr]={}}if(length===6){properties.days[chr][length]=cldr.main(["dates/calendars/gregorian/days",chr==="c"?"stand-alone":"format","short"])||cldr.main(["dates/calendars/gregorian/days",chr==="c"?"stand-alone":"format","abbreviated"])}else{properties.days[chr][length]=cldr.main(["dates/calendars/gregorian/days",chr==="c"?"stand-alone":"format",widths[length<3?0:length-3]])}break;case"a":properties.dayPeriods={am:cldr.main("dates/calendars/gregorian/dayPeriods/format/wide/am"),pm:cldr.main("dates/calendars/gregorian/dayPeriods/format/wide/pm")};break;case"h":case"H":case"K":case"k":case"m":case"s":case"S":case"A":formatNumber=true;break;case"z":case"O":properties.gmtFormat=cldr.main("dates/timeZoneNames/gmtFormat");properties.gmtZeroFormat=cldr.main("dates/timeZoneNames/gmtZeroFormat");properties.tzLongHourFormat=cldr.main("dates/timeZoneNames/hourFormat");case"Z":case"X":case"x":setNumberFormatterPattern(1);setNumberFormatterPattern(2);break;case"v":case"V":throw createErrorUnsupportedFeature({feature:"timezone pattern `"+chr+"`"})}if(formatNumber){setNumberFormatterPattern(length)}});return properties}});